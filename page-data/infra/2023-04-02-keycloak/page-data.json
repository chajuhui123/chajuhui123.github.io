{"componentChunkName":"component---src-templates-blog-post-js","path":"/infra/2023-04-02-keycloak/","result":{"data":{"site":{"siteMetadata":{"title":""}},"markdownRemark":{"id":"ca7a01df-a39a-5c6d-a69e-bfe73ce104f6","excerpt":"Keycloak? Keycloak은 ID 및 액세스 관리 솔루션을 제공하는 오픈소스입니다. 과 를 쉽게 해주고 SSO(Single-Sign-On) 기능을 제공합니다. Kubernetes, MSA 환경에 최적화 된 솔루션입니다. SSO…","html":"<h2>Keycloak?</h2>\n<p>Keycloak은 ID 및 액세스 관리 솔루션을 제공하는 오픈소스입니다.</p>\n<p><code class=\"language-text\">인증(Authentication)</code>과 <code class=\"language-text\">인가(Authorization)</code>를 쉽게 해주고 SSO(Single-Sign-On) 기능을 제공합니다.</p>\n<p>Kubernetes, MSA 환경에 최적화 된 솔루션입니다.</p>\n<hr>\n<h2>SSO?</h2>\n<p><code class=\"language-text\">SSO</code>(<code class=\"language-text\">Single-Sign-On</code>)는 한 번의 로그인을 통해, 연결된 다른 사이트들을 자동으로 접속해 이용할 수 있게 하는 서비스입니다.</p>\n<p>하나(Single)의 아이디와 패스워드를 통해(Sign) 여러 시스템에 접근(On)할 수 있도록 하는 <code class=\"language-text\">통합 인증 솔루션</code>이라고 정리할 수 있습니다.</p>\n<h3>SSO 활용 사례</h3>\n<p>일반적인 인증, 인가 시스템을 살펴보면, 각 서비스에서 각 DB에 사용자 정보가 있고 그 정보를 통해서 로그인을 관리합니다. 하지만 필요에 따라 사용자 정보를 연동하여 사용해야 하는 경우가 발생합니다.</p>\n<p>이런 경우에 <code class=\"language-text\">SSO</code> 기능을 사용할 수 있으며, 하나의 시스템에서 인증을 할 경우 그와 연결된 다른 시스템에서는 인증 정보가 있는지 없는지를 확인하여 이후 처리를 하도록 설계하는 것입니다.</p>\n<ul>\n<li>Ex. 회사 내부에서 다양한 시스템을 운영하고 있는 경우, 각 DB에 사원 정보를 중복으로 관리하기 보단, SSO 인증 방식을 활용하는 것이 적합합니다.</li>\n</ul>\n<hr>\n<h2>제공 기능</h2>\n<ul>\n<li>SSO</li>\n<li>ID 중개 와 소셜 로그인 (OpenID, SAML, GitHub, Google 등)</li>\n<li>관리자 / 계정관리 콘솔 제공</li>\n<li>표준 프로토콜 지원(<code class=\"language-text\">OpenID Connect</code> + <code class=\"language-text\">OAuth2.0</code>, SAML)\n<ul>\n<li><code class=\"language-text\">OIDC</code> : Oauth 2.0의 확장 인증 프로토콜로, <strong>인증</strong>(증명, token…)에 초점을 맞춥니다.</li>\n<li><code class=\"language-text\">OAuth 2.0</code> : 권한 부여 프레임워크로, 데이터에 대한 <strong>액세스 권한 부여</strong>에 초점을 맞춥니다. (인증 프로토콜 X)</li>\n<li>둘은 목적에 차이가 있으며, <strong>keyCloak은 기본 인증 방식이 OAuth 2.0을 베이스로 하는 OIDC</strong> 입니다.</li>\n</ul>\n</li>\n<li>다수의 플랫폼과 프로그래밍 언어가 사용가능한 adapter를 가짐</li>\n</ul>\n<h2>주요 용어</h2>\n<ul>\n<li>\n<p>Realm (랠름)</p>\n<ul>\n<li>인증, 권한 부여가 적용되는 범위의 단위입니다.</li>\n</ul>\n</li>\n<li>\n<p>Client</p>\n<ul>\n<li>Client는 인증, 권한 부여 행위를 수행할 어플리케이션을 나타내는 단위입니다.</li>\n<li>하나의 realm 안에는 다수의 client가 들어갈 수 있으며, realm의 관리자가 각각의 client를 관리할 수 있습니다. client는 보통 서비스 단위로 생성되고 관리한다고 합니다.</li>\n</ul>\n</li>\n<li>\n<p>User</p>\n<ul>\n<li>인증을 필요로하는 사용자를 나타냅니다.</li>\n<li>기본적인 User 정보는 username, email, firstname, lastname으로 구성되어 있지만, custom user attribute를 사용하여 원하는 속성을 추가할 수 있습니다.</li>\n<li>(+ custom attribute가 사용자 등록 및 관리 화면에도 노출되기 위해서는 커스텀 테마 등록 및 수정이 필요하다고 합니다.)</li>\n</ul>\n</li>\n<li>\n<p>Role</p>\n<ul>\n<li>User에게 부여할 권한을 나타냅니다.</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2>Keycloak 구축하기</h2>\n<ul>\n<li><a href=\"https://www.youtube.com/watch?v=dFPGO5jDHPY\">NHN Cloud의 Keycloak 인증 서버 선정 이유</a>\n<ul>\n<li>무료 오픈 소스을 통한 운영</li>\n<li>다양한 인증 연동 방식 제공</li>\n<li>전체 사내 서비스 연동 목표</li>\n<li>대중적인 SSO (github start)</li>\n</ul>\n</li>\n</ul>\n<h3>로그인 과정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/df4d4bc47b0e91b50fb342f5efd72b14/14747/keycloack-login-logic.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABNklEQVQoz31RCXKDMAzk/58kaUnSkgMfgMG2tBnLmIS21DMayfZqpZUqAPDeg4hQztD3UErBOSf39GethdYafp5RcozW8l5ymRlVCowxAgCzWNu2qOsaWqmV8HI+4+N4xDgM8jaOI46HA05NgxDClpCJQM4g3j8RuxN4VADFDAoevMTlpMS9UxVASspGr3uYpQiZq8QUw4ZQcG/xizCRpC4SIHqQvSOqC0i3yx8JYemUl9G8E24lJ7B3WZ6fQH2HaK7i5U/M/5L6f4dr4gSyN8R7kzv001JwWrvMFsBM4Mz2t2QBLKCfY08JNKi8uEeTvb2tuBehsJf2F8LShZ8Qu3OWnginPo9mHsVT8nuSqX+A1BdIfyN2lzWZnAXPQ5abtrwpTDuE0efKaU5iTsAbyXlUa7y3lCcZNmItL3HeowAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"로그인 과정\"\n        title=\"로그인 과정\"\n        src=\"/static/df4d4bc47b0e91b50fb342f5efd72b14/f058b/keycloack-login-logic.png\"\n        srcset=\"/static/df4d4bc47b0e91b50fb342f5efd72b14/c26ae/keycloack-login-logic.png 158w,\n/static/df4d4bc47b0e91b50fb342f5efd72b14/6bdcf/keycloack-login-logic.png 315w,\n/static/df4d4bc47b0e91b50fb342f5efd72b14/f058b/keycloack-login-logic.png 630w,\n/static/df4d4bc47b0e91b50fb342f5efd72b14/40601/keycloack-login-logic.png 945w,\n/static/df4d4bc47b0e91b50fb342f5efd72b14/78612/keycloack-login-logic.png 1260w,\n/static/df4d4bc47b0e91b50fb342f5efd72b14/14747/keycloack-login-logic.png 1914w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>주로 아래 내용들이 커스텀 할 수 있는 기능입니다.\n<ul>\n<li>외부 저장소 연동</li>\n<li>로그인 로직</li>\n<li>로그인 페이지에 대한 설정</li>\n</ul>\n</li>\n</ul>\n<h3>User Storage Federation (외부 저장소 관련 기능)</h3>\n<p>Keycloak 에서는 3가지 방식의 연동을 지원합니다.</p>\n<ul>\n<li>LDAP</li>\n<li>Kerberos</li>\n<li>User Storage SPI</li>\n</ul>\n<h3>Authentication SPI (인증 로직 수정 관련 기능)</h3>\n<p>로그인 관련 로직을 추가할 때 활용할 수 있습니다. 아래는 예제 케이스입니다.</p>\n<ul>\n<li>로그인 가능한 아이디 종류를 늘린다. (사원번호, 이메일, 아이디 등…)</li>\n<li>5회 비밀번호 틀릴시, 계정을 임시 잠금 상태로 바꾼다.</li>\n<li>임시 잠금 상태의 계정으로 로그인시, 비밀번호 변경 화면으로 이동시킨다.</li>\n</ul>\n<h3>Theme (로그인 페이지 수정 기능)</h3>\n<ul>\n<li>커스텀한 로그인 페이지를 노출시킬 수 있습니다.</li>\n</ul>","frontmatter":{"title":"인증, 인가를 관리하고 SSO 로그인을 제공하는 오픈소스 'Keycloak'","category":"infra","date":"April 02, 2023","description":null}},"previous":{"fields":{"slug":"/infra/2023-03-26-ec2/"},"frontmatter":{"title":"AWS SSH 키 등록 및 EC2 접속 방법"}},"next":{"fields":{"slug":"/infra/2023-04-11-hashicorp/"},"frontmatter":{"title":"HashiCorp Strategy Day 2023에 다녀오다!"}}},"pageContext":{"id":"ca7a01df-a39a-5c6d-a69e-bfe73ce104f6","previousPostId":"a60cace7-1001-5a2e-8018-1f9fa2335fbf","nextPostId":"2b4d5e20-4ae0-540c-a74b-679aa5801ad8"}},"staticQueryHashes":["2841359383","3274528899"]}